---
layout: default
---

<div class="version-page">
  <h1>OCP {{ page.version }} Compliance Status</h1>

  {% assign version_slug = page.version | replace: ".", "_" %}
  {% assign data_file = "ocp-" | append: version_slug %}
  {% assign version_data = site.data[data_file] %}

  {% if version_data %}
  <div class="scan-info">
    <p><strong>Last Scan:</strong> {{ version_data.scan_date | date: "%Y-%m-%d %H:%M UTC" }}</p>
  </div>

  <div class="summary-cards">
    <div class="card total">
      <h3>Total Checks</h3>
      <span class="number">{{ version_data.summary.total_checks }}</span>
    </div>
    <div class="card passing">
      <h3>Passing</h3>
      <span class="number">{{ version_data.summary.passing }}</span>
    </div>
    <div class="card failing">
      <h3>Failing</h3>
      <span class="number">{{ version_data.summary.failing }}</span>
    </div>
    <div class="card manual">
      <h3>Manual</h3>
      <span class="number">{{ version_data.summary.manual }}</span>
    </div>
  </div>

  <div class="coverage-bar">
    {% assign coverage = version_data.summary.passing | times: 100 | divided_by: version_data.summary.total_checks %}
    <div class="progress" style="width: {{ coverage }}%"></div>
    <span class="coverage-text">{{ coverage }}% Coverage</span>
  </div>

  <!-- Tab Navigation -->
  <div class="tabs-container">
    <div class="tab-nav">
      <button class="tab-btn active" data-tab="failing" onclick="switchTab('failing')">
        <span class="tab-icon">&#10060;</span>
        Failing
        <span class="tab-count fail-count">{{ version_data.summary.failing }}</span>
      </button>
      <button class="tab-btn" data-tab="passing" onclick="switchTab('passing')">
        <span class="tab-icon">&#9989;</span>
        Passing
        <span class="tab-count pass-count">{{ version_data.summary.passing }}</span>
      </button>
    </div>

    <!-- Failing Tab Content -->
    <div class="tab-panel active" id="panel-failing">
      {% if version_data.remediations.high.size > 0 %}
      <section class="remediation-section">
        <h2><span class="severity-badge high">HIGH</span> Severity Failing Checks ({{ version_data.remediations.high.size }})</h2>
        {% include remediation-table.html checks=version_data.remediations.high severity="high" %}
      </section>
      {% endif %}

      {% if version_data.remediations.medium.size > 0 %}
      <section class="remediation-section">
        <h2><span class="severity-badge medium">MEDIUM</span> Severity Failing Checks ({{ version_data.remediations.medium.size }})</h2>
        {% include remediation-table.html checks=version_data.remediations.medium severity="medium" %}
      </section>
      {% endif %}

      {% if version_data.remediations.low.size > 0 %}
      <section class="remediation-section">
        <h2><span class="severity-badge low">LOW</span> Severity Failing Checks ({{ version_data.remediations.low.size }})</h2>
        {% include remediation-table.html checks=version_data.remediations.low severity="low" %}
      </section>
      {% endif %}

      {% if version_data.manual_checks.size > 0 %}
      <section class="remediation-section">
        <h2><span class="severity-badge manual">MANUAL</span> Checks Requiring Review ({{ version_data.manual_checks.size }})</h2>
        {% include remediation-table.html checks=version_data.manual_checks severity="manual" %}
      </section>
      {% endif %}

      {% if version_data.remediations.high.size == 0 and version_data.remediations.medium.size == 0 and version_data.remediations.low.size == 0 and version_data.manual_checks.size == 0 %}
      <div class="no-data">
        <p>No failing checks found.</p>
      </div>
      {% endif %}
    </div>

    <!-- Passing Tab Content -->
    <div class="tab-panel" id="panel-passing">
      {% if version_data.passing_checks.high.size > 0 %}
      <section class="remediation-section">
        <h2><span class="severity-badge high">HIGH</span> Severity Passing Checks ({{ version_data.passing_checks.high.size }})</h2>
        {% include passing-table.html checks=version_data.passing_checks.high %}
      </section>
      {% endif %}

      {% if version_data.passing_checks.medium.size > 0 %}
      <section class="remediation-section">
        <h2><span class="severity-badge medium">MEDIUM</span> Severity Passing Checks ({{ version_data.passing_checks.medium.size }})</h2>
        {% include passing-table.html checks=version_data.passing_checks.medium %}
      </section>
      {% endif %}

      {% if version_data.passing_checks.low.size > 0 %}
      <section class="remediation-section">
        <h2><span class="severity-badge low">LOW</span> Severity Passing Checks ({{ version_data.passing_checks.low.size }})</h2>
        {% include passing-table.html checks=version_data.passing_checks.low %}
      </section>
      {% endif %}

      {% if version_data.passing_checks.high.size == 0 and version_data.passing_checks.medium.size == 0 and version_data.passing_checks.low.size == 0 %}
      <div class="no-data">
        <p>No passing checks data available. Re-export compliance data to include passing checks.</p>
      </div>
      {% endif %}
    </div>
  </div>

  {% else %}
  <div class="no-data">
    <p>No compliance data available for OCP {{ page.version }}.</p>
    <p>Run <code>make export-compliance OCP_VERSION={{ page.version }}</code> to collect data.</p>
  </div>
  {% endif %}
</div>

<script>
function switchTab(tabName) {
  // Remove active class from all buttons and panels
  document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
  document.querySelectorAll('.tab-panel').forEach(panel => panel.classList.remove('active'));

  // Add active class to selected button and panel
  document.querySelector('[data-tab="' + tabName + '"]').classList.add('active');
  document.getElementById('panel-' + tabName).classList.add('active');
}
</script>

{{ content }}
