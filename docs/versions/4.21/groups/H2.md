---
layout: group
title: PAM Empty Passwords
group_id: H2
version: "4.21"
severity: HIGH
status: in_progress
jira: CNF-21212
pr: 529
prev_group: H1
next_group: H3
---

## Overview

This remediation disables the `nullok` option in PAM (Pluggable Authentication Modules) configuration, preventing authentication with empty passwords.

## Settings

| Setting | Description |
|---------|-------------|
| `no-empty-passwords` | Disable `nullok` in PAM system-auth and password-auth |

## Implementation

The remediation applies a MachineConfig that modifies PAM configuration files to remove the `nullok` option:

```yaml
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  name: 75-pam-auth-high
  labels:
    machineconfiguration.openshift.io/role: master
spec:
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
        - path: /etc/pam.d/system-auth
          mode: 0644
          overwrite: true
          contents:
            source: data:text/plain;charset=utf-8;base64,...
        - path: /etc/pam.d/password-auth
          mode: 0644
          overwrite: true
          contents:
            source: data:text/plain;charset=utf-8;base64,...
```

The PAM files are configured to require proper authentication without allowing empty passwords.

## Compliance Checks Remediated

This group addresses the following compliance checks:

| Check | Profile | Description |
|-------|---------|-------------|
| `rhcos4-e8-worker-no-empty-passwords` | E8 | Prevent empty password authentication (worker) |
| `rhcos4-e8-master-no-empty-passwords` | E8 | Prevent empty password authentication (master) |

<div class="source-files">
<h4>Source Remediation Files</h4>
<ul>
<li>high/rhcos4-e8-worker-no-empty-passwords.yaml</li>
<li>high/rhcos4-e8-master-no-empty-passwords.yaml</li>
</ul>
</div>

## Verification

After applying the MachineConfig, verify PAM configuration on a node:

```bash
oc debug node/<node-name> -- chroot /host grep nullok /etc/pam.d/system-auth /etc/pam.d/password-auth
# Expected: No output (nullok should not be present)
```

## Security Impact

Disabling empty passwords ensures that:
- All user accounts must have a password set
- SSH and console logins require proper authentication
- Compliance with CIS and Essential Eight security benchmarks
