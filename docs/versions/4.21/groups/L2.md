---
layout: group
title: Sysctl dmesg_restrict
group_id: L2
version: "4.21"
severity: LOW
status: pending
jira:
pr:
compare: compliance/4.21/l2-sysctl-dmesg
prev_group: L1
next_group:
---

## Overview

This remediation restricts access to kernel ring buffer messages (dmesg) to privileged users only, preventing information disclosure about kernel internals.

## Settings

| Setting | Value | Description |
|---------|-------|-------------|
| `kernel.dmesg_restrict` | `1` | Restrict kernel log access to privileged users |

## Implementation

```yaml
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  name: 75-sysctl-low
  labels:
    machineconfiguration.openshift.io/role: master
spec:
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
        - path: /etc/sysctl.d/75-dmesg-restrict.conf
          mode: 0644
          overwrite: true
          contents:
            inline: |
              # Restrict dmesg access to root
              kernel.dmesg_restrict = 1
```

## Compliance Checks Remediated

| Check | Profile | Docs |
|-------|---------|------|
| `rhcos4-e8-worker-sysctl-kernel-dmesg-restrict` | E8 | [ðŸ“–](https://github.com/ComplianceAsCode/content/tree/master/linux_os/guide/system/permissions/restrictions/sysctl_kernel_dmesg_restrict) |
| `rhcos4-e8-master-sysctl-kernel-dmesg-restrict` | E8 | [ðŸ“–](https://github.com/ComplianceAsCode/content/tree/master/linux_os/guide/system/permissions/restrictions/sysctl_kernel_dmesg_restrict) |

<div class="source-files">
<h4>Source Remediation Files</h4>
<ul>
<li>low/rhcos4-e8-worker-sysctl-kernel-dmesg-restrict.yaml</li>
<li>low/rhcos4-e8-master-sysctl-kernel-dmesg-restrict.yaml</li>
</ul>
</div>

## Verification

After applying, verify the sysctl setting:

```bash
oc debug node/<node-name> -- chroot /host sysctl kernel.dmesg_restrict
# Expected: kernel.dmesg_restrict = 1
```

## Security Impact

Restricting dmesg access prevents:
- Information disclosure about kernel modules
- Leaking kernel addresses useful for exploitation
- Exposure of hardware configuration details
- Reconnaissance by unprivileged users

## When dmesg_restrict = 0

Unprivileged users can run:
```bash
dmesg
```
And see kernel messages including:
- Loaded modules
- Hardware detection
- Kernel addresses (useful for ASLR bypass)

## When dmesg_restrict = 1

Only root (CAP_SYSLOG) can access kernel logs via dmesg.
