---
layout: group
title: Crypto Policy
group_id: H1
version: "4.21"
severity: HIGH
status: in_progress
priority: 1
priority_label: Critical
jira: CNF-21212
pr: 529
prev_group:
next_group: H2
---

## Overview

This remediation configures the system-wide cryptographic policy to disable SHA1, improving the security posture of RHCOS nodes by enforcing stronger cryptographic standards.

## Settings

| Setting | Value | Description |
|---------|-------|-------------|
| `crypto-policy` | `DEFAULT:NO-SHA1` | System-wide crypto policy without SHA1 |

## Implementation

The remediation applies a MachineConfig that sets the crypto policy via a systemd unit:

```yaml
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  name: 75-crypto-policy-high
  labels:
    machineconfiguration.openshift.io/role: master
spec:
  config:
    ignition:
      version: 3.2.0
    systemd:
      units:
        - name: configure-crypto-policy.service
          enabled: true
          contents: |
            [Unit]
            Description=Configure System Crypto Policy
            Before=sshd.service
            After=systemd-machine-id-commit.service
            ConditionFirstBoot=no

            [Service]
            Type=oneshot
            ExecStart=/usr/bin/update-crypto-policies --set DEFAULT:NO-SHA1
            RemainAfterExit=yes

            [Install]
            WantedBy=multi-user.target
```

## Compliance Checks Remediated

This group addresses the following compliance checks:

| Check | Profile | Description | Docs |
|-------|---------|-------------|------|
| `rhcos4-e8-worker-configure-crypto-policy` | E8 | Configure system crypto policy (worker) | [ðŸ“–](https://github.com/ComplianceAsCode/content/tree/master/linux_os/guide/system/software/integrity/crypto/configure_crypto_policy) |
| `rhcos4-e8-master-configure-crypto-policy` | E8 | Configure system crypto policy (master) | [ðŸ“–](https://github.com/ComplianceAsCode/content/tree/master/linux_os/guide/system/software/integrity/crypto/configure_crypto_policy) |

<div class="source-files">
<h4>Source Remediation Files</h4>
<ul>
<li>high/rhcos4-e8-worker-configure-crypto-policy.yaml</li>
<li>high/rhcos4-e8-master-configure-crypto-policy.yaml</li>
</ul>
</div>

## Verification

After applying the MachineConfig, verify the crypto policy on a node:

```bash
oc debug node/<node-name> -- chroot /host update-crypto-policies --show
# Expected output: DEFAULT:NO-SHA1
```

## Related Links

- [Red Hat Crypto Policies Documentation](https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/8/html/security_hardening/using-the-system-wide-cryptographic-policies_security-hardening)
- [NIST SP 800-131A Rev 2](https://csrc.nist.gov/publications/detail/sp/800-131a/rev-2/final) - Transitioning cryptographic algorithms
