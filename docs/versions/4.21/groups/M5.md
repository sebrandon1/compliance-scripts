---
layout: group
title: Audit Rules - Kernel Modules
group_id: M5
version: "4.21"
severity: MEDIUM
status: pending
priority: 3
priority_label: Medium
jira:
pr:
compare: compliance/4.21/m5-audit-modules
prev_group: M4
next_group: M6
---

## Overview

This remediation configures audit rules to monitor kernel module loading and unloading operations, which are critical for detecting rootkit installation attempts.

## Settings

| Rule | Description |
|------|-------------|
| `delete_module` | Audit kernel module unloading (rmmod) |
| `finit_module` | Audit kernel module loading (finit) |
| `init_module` | Audit kernel module loading (init) |

## Implementation

```yaml
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfig
metadata:
  name: 75-audit-modules-medium
  labels:
    machineconfiguration.openshift.io/role: master
spec:
  config:
    ignition:
      version: 3.2.0
    storage:
      files:
        - path: /etc/audit/rules.d/75-kernel-modules.rules
          mode: 0644
          overwrite: true
          contents:
            inline: |
              ## Kernel module monitoring
              -a always,exit -F arch=b64 -S init_module -S finit_module -k module_load
              -a always,exit -F arch=b32 -S init_module -S finit_module -k module_load
              -a always,exit -F arch=b64 -S delete_module -k module_unload
              -a always,exit -F arch=b32 -S delete_module -k module_unload
```

## Compliance Checks Remediated

| Check | Profile | Docs |
|-------|---------|------|
| `rhcos4-e8-worker-audit-rules-kernel-module-loading-delete` | E8 | [ðŸ“–](https://github.com/ComplianceAsCode/content/tree/master/linux_os/guide/auditing/auditd_configure_rules/audit_kernel_module_loading) |
| `rhcos4-e8-worker-audit-rules-kernel-module-loading-finit` | E8 | [ðŸ“–](https://github.com/ComplianceAsCode/content/tree/master/linux_os/guide/auditing/auditd_configure_rules/audit_kernel_module_loading) |
| `rhcos4-e8-worker-audit-rules-kernel-module-loading-init` | E8 | [ðŸ“–](https://github.com/ComplianceAsCode/content/tree/master/linux_os/guide/auditing/auditd_configure_rules/audit_kernel_module_loading) |

<div class="source-files">
<h4>Source Remediation Files</h4>
<ul>
<li>medium/rhcos4-e8-worker-audit-rules-kernel-module-loading-delete.yaml</li>
<li>medium/rhcos4-e8-worker-audit-rules-kernel-module-loading-finit.yaml</li>
<li>medium/rhcos4-e8-worker-audit-rules-kernel-module-loading-init.yaml</li>
</ul>
</div>

## Security Impact

Kernel module auditing is essential because:
- Rootkits often install via kernel modules
- Unauthorized modules can bypass security controls
- Module loading should be rare on production systems
