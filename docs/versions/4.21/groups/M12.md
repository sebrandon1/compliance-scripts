---
layout: group
title: Audit Profile
group_id: M12
version: "4.21"
severity: MEDIUM
status: pending
jira:
pr:
prev_group: M11
next_group: L1
---

## Overview

This remediation configures the OpenShift API server audit logging to capture request and response bodies, providing enhanced visibility into cluster operations.

## Settings

| Setting | Value | Description |
|---------|-------|-------------|
| `audit.profile` | `WriteRequestBodies` | Enhanced audit logging with request bodies |

## Implementation

Modify the APIServer custom resource:

```yaml
apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  audit:
    profile: WriteRequestBodies
```

Apply with:
```bash
oc patch apiserver cluster --type merge -p '{"spec":{"audit":{"profile":"WriteRequestBodies"}}}'
```

## Audit Profile Options

| Profile | Description |
|---------|-------------|
| `Default` | Log metadata for all requests |
| `WriteRequestBodies` | Log metadata and request bodies for write operations |
| `AllRequestBodies` | Log metadata and request bodies for all operations |
| `None` | Disable API audit logging (not recommended) |

## Compliance Checks Remediated

| Check | Profile | Docs |
|-------|---------|------|
| `ocp4-cis-audit-profile-set` | CIS | [ðŸ“–](https://docs.openshift.com/container-platform/latest/security/audit-log-policy-config.html) |

<div class="source-files">
<h4>Source Remediation Files</h4>
<ul>
<li>medium/ocp4-cis-audit-profile-set.yaml</li>
</ul>
</div>

## Verification

Check current audit profile:

```bash
oc get apiserver cluster -o jsonpath='{.spec.audit.profile}'
# Expected: WriteRequestBodies
```

## Security Impact

Enhanced audit logging provides:
- Full request body capture for forensic analysis
- Visibility into what was created/modified
- Compliance evidence for security audits
- Incident response capability

> **Note**: WriteRequestBodies increases log volume. Ensure adequate log storage capacity.
