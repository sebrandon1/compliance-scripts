---
layout: group
group_id: M10
version: "4.21"
---

## Overview

This remediation enables encryption at rest for etcd data in the OpenShift API server, protecting sensitive data stored in the cluster's key-value store.

## Settings

| Setting | Value | Description |
|---------|-------|-------------|
| `encryption.type` | `aescbc` | Enable AES-CBC encryption at rest |

## Implementation

This requires modifying the APIServer custom resource:

```yaml
apiVersion: config.openshift.io/v1
kind: APIServer
metadata:
  name: cluster
spec:
  encryption:
    type: aescbc
```

Apply with:
```bash
oc patch apiserver cluster --type merge -p '{"spec":{"encryption":{"type":"aescbc"}}}'
```

## Compliance Checks Remediated

| Check | Profile | Docs |
|-------|---------|------|
| `ocp4-cis-api-server-encryption-provider-cipher` | CIS | [ðŸ“–](https://docs.openshift.com/container-platform/latest/security/encrypting-etcd.html) |
| `ocp4-e8-api-server-encryption-provider-cipher` | E8 | [ðŸ“–](https://docs.openshift.com/container-platform/latest/security/encrypting-etcd.html) |

<div class="source-files">
<h4>Source Remediation Files</h4>
<ul>
<li>medium/ocp4-cis-api-server-encryption-provider-cipher.yaml</li>
<li>medium/ocp4-e8-api-server-encryption-provider-cipher.yaml</li>
</ul>
</div>

## Verification

Check encryption status:

```bash
oc get apiserver cluster -o jsonpath='{.spec.encryption.type}'
# Expected: aescbc

# Verify encryption is active
oc get openshiftapiserver -o=jsonpath='{range .items[0].status.conditions[?(@.type=="Encrypted")]}{.type}{" "}{.status}{" "}{.reason}{"\n"}{end}'
```

## Security Impact

Encryption at rest ensures:
- Secrets stored in etcd are encrypted
- Stolen etcd backups are protected
- Compliance with data protection requirements
- Defense in depth for sensitive configuration
